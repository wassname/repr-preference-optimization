+ python scripts/train.py side-none-InnerDPO --base_model=wassname/Qwen3-0.6B-sft --dataset=math --batch_size=18 --dev --verbose=0
[1mRandom seed set to 42 for all libraries[0m
[1mPL_MODEL <class 'reprpo.interventions.reprpo.model.PL_REPRPO_MODEL'>[0m
[1mdiff: ReprPO_None_InnerDPO base_model=wassname/Qwen3-0.6B-sft batch_size=18 dev=True eval_samples=32 innerdpo.align_method=para innerdpo.eps=1e-05 innerdpo.norm_before_reduce=True innerdpo.Î±=0.25 verbose=0[0m
[32m250606 00:54:31[0m|[1mINFO[0m|[36mreprpo.helpers.logging[0m:[36msetup_logging[0m#[36m32[0m - [1mLogging initialized. Level=INFO, dir=/workspace/repr-preference-optimization/outputs/math-Qwen3-0.6B-sft/wassname-Qwen3-06B-sft_side-None-InnerDPO_math/2025-06-06_00-54-31[0m
[32m250606 00:54:31[0m|[1mINFO[0m|[36mreprpo.training[0m:[36mtrain[0m#[36m119[0m - [1mLogging initialized at /workspace/repr-preference-optimization/outputs/math-Qwen3-0.6B-sft/wassname-Qwen3-06B-sft_side-None-InnerDPO_math/2025-06-06_00-54-31[0m
[32m250606 00:54:35[0m|[1mINFO[0m|[36mreprpo.models.load[0m:[36mprint_trainable_parameters[0m#[36m20[0m - [1mtrainable params: 40370176 || all params: 636146688 || trainable%: 6.346048287529558[0m
[32m250606 00:54:43[0m|[1mINFO[0m|[36mreprpo.interventions.reprpo.model[0m:[36m__init__[0m#[36m194[0m - [1mUsing collection layers: [8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25] for NoneConfig[0m
[32m250606 00:54:45[0m|[33m[1mWARNING[0m|[36mreprpo.data.datamodule[0m:[36msetup[0m#[36m19[0m - [33m[1mDataset already loaded, skipping setup.[0m
[32m250606 00:54:50[0m|[1mINFO[0m|[36mreprpo.lightning.pl_gen[0m:[36mon_train_epoch_end[0m#[36m41[0m - [1m
Generated at end of epoch 0[0m
[32m250606 00:54:54[0m|[1mINFO[0m|[36mreprpo.eval.gen[0m:[36mdisplay_gen[0m#[36m195[0m - [1m--------------------------------------------------------------------------------
**Adapter:`side-None-InnerDPO` generation**`
`The SolidGoldMagikarp, a non-carbon-based alien, first encountered humanity 100 years ago. They were fascinated by the carbon-based life forms and decided to explore the universe. They discovered that humans had a unique ability to create and manipulate matter, and they were amazed by the possibilities. They soon`
--------------------------------------------------------------------------------
**Adapter:`base` generation**`
`The SolidGoldMagikarp, a non-carbon-based alien, first encountered humanity 100 years ago. They were fascinated by the carbon-based life forms and decided to explore the universe. They discovered that humans had a unique ability to create and manipulate matter, and they were amazed by the possibilities. They soon`
================================================================================
[0m
[32m250606 00:54:55[0m|[1mINFO[0m|[36mreprpo.training[0m:[36mtrain[0m#[36m275[0m - [1msaved to /workspace/repr-preference-optimization/outputs/math-Qwen3-0.6B-sft/wassname-Qwen3-06B-sft_side-None-InnerDPO_math/2025-06-06_00-54-31/adapter[0m
[32m250606 00:55:07[0m|[1mINFO[0m|[36mreprpo.training[0m:[36mtrain[0m#[36m306[0m - [1mevaluating on datasets: ['genies_preferences-math-test[:32]', 'genies_preferences-change_my_view-test[:32]', 'genies_preferences-math_fiction-test[:32]', 'ethics_expression_preferences-justice-test[:32]', 'ethics_expression_preferences-utilitarianism-test[:32]', 'medical-dpo-v2-test-data[:32]'][0m
[32m250606 00:55:15[0m|[1mINFO[0m|[36mreprpo.training[0m:[36mtrain[0m#[36m341[0m - [1msave_dir=/workspace/repr-preference-optimization/outputs/math-Qwen3-0.6B-sft/wassname-Qwen3-06B-sft_side-None-InnerDPO_math/2025-06-06_00-54-31[0m
[32m250606 00:55:15[0m|[1mINFO[0m|[36mreprpo.training[0m:[36mtrain[0m#[36m342[0m - [1mHuman name: ReprPO_None_InnerDPO innerdpo.align_method=para innerdpo.eps=1e-05 innerdpo.norm_before_reduce=True innerdpo.Î±=0.25[0m
[32m250606 00:55:16[0m|[1mINFO[0m|[36mreprpo.training[0m:[36mmake_table[0m#[36m412[0m - [1m
| adapter/distribution_shift   |   in_domain |   cross_domain |   moral_transfer |   orthogonal |
|:-----------------------------|------------:|---------------:|-----------------:|-------------:|
| none                         |       0.844 |          0.656 |            0.328 |         0.25 |
| side-None-InnerDPO           |       0.844 |          0.656 |            0.328 |         0.25 |[0m
[32m250606 00:55:16[0m|[1mINFO[0m|[36mreprpo.training[0m:[36mmake_table[0m#[36m413[0m - [1mTable 1: Absolute accuracy after training with named adapter on ds:`math` compared to base model `Qwen3-0.6B-sft` for various distribution shifts [N=32]:
- Shift: cross_domain, made up of:
	- `genies_preferences-change_my_view-test[:32]`
	- `genies_preferences-math_fiction-test[:32]`
- Shift: in_domain, made up of:
	- `genies_preferences-math-test[:32]`
- Shift: moral_transfer, made up of:
	- `ethics_expression_preferences-utilitarianism-test[:32]`
	- `ethics_expression_preferences-justice-test[:32]`
- Shift: orthogonal, made up of:
	- `medical-dpo-v2-test-data[:32]`
[0m
[32m250606 00:55:16[0m|[1mINFO[0m|[36mreprpo.training[0m:[36mmake_table[0m#[36m416[0m - [1m
| ds_name_nice                                 |   none |   side-None-InnerDPO |
|:---------------------------------------------|-------:|---------------------:|
| cross_domain (change_my_view_test )          |  0.531 |                0.531 |
| cross_domain (math_fiction_test )            |  0.781 |                0.781 |
| in_domain (math_test )                       |  0.844 |                0.844 |
| moral_transfer (ethics_justice_test )        |  0.25  |                0.25  |
| moral_transfer (ethics_utilitarianism_test ) |  0.406 |                0.406 |
| orthogonal (medical_dpo_v2_test_data )       |  0.25  |                0.25  |[0m
[32m250606 00:55:16[0m|[1mINFO[0m|[36mreprpo.training[0m:[36mmake_table[0m#[36m417[0m - [1mTable 2: Absolute accuracy after training with named adapter on ds:`math` compared to base model `Qwen3-0.6B-sft` for various distribution shifts [N=32]:
[0m
+ python scripts/train.py side-none-InnerDPO --base_model=allenai/OLMo-2-0425-1B-SFT --dataset=math --batch_size=13 --dev --verbose=0
[1mRandom seed set to 42 for all libraries[0m
[1mPL_MODEL <class 'reprpo.interventions.reprpo.model.PL_REPRPO_MODEL'>[0m
[1mdiff: ReprPO_None_InnerDPO base_model=allenai/OLMo-2-0425-1B-SFT batch_size=13 dev=True eval_samples=32 innerdpo.align_method=para innerdpo.eps=1e-05 innerdpo.norm_before_reduce=True innerdpo.Î±=0.25 verbose=0[0m
[32m250606 00:55:23[0m|[1mINFO[0m|[36mreprpo.helpers.logging[0m:[36msetup_logging[0m#[36m32[0m - [1mLogging initialized. Level=INFO, dir=/workspace/repr-preference-optimization/outputs/math-OLMo-2-0425-1B-SFT/allenai-OLMo-2-0425-1B-SFT_side-None-InnerDPO_math/2025-06-06_00-55-23[0m
[32m250606 00:55:23[0m|[1mINFO[0m|[36mreprpo.training[0m:[36mtrain[0m#[36m119[0m - [1mLogging initialized at /workspace/repr-preference-optimization/outputs/math-OLMo-2-0425-1B-SFT/allenai-OLMo-2-0425-1B-SFT_side-None-InnerDPO_math/2025-06-06_00-55-23[0m
[32m250606 00:55:28[0m|[1mINFO[0m|[36mreprpo.models.load[0m:[36mprint_trainable_parameters[0m#[36m20[0m - [1mtrainable params: 48234496 || all params: 1533151232 || trainable%: 3.146101636501832[0m
[32m250606 00:55:34[0m|[1mINFO[0m|[36mreprpo.interventions.reprpo.model[0m:[36m__init__[0m#[36m194[0m - [1mUsing collection layers: [4, 5, 6, 7, 8, 9, 10, 11, 12, 13] for NoneConfig[0m
[32m250606 00:55:35[0m|[33m[1mWARNING[0m|[36mreprpo.data.datamodule[0m:[36msetup[0m#[36m19[0m - [33m[1mDataset already loaded, skipping setup.[0m
[32m250606 00:55:39[0m|[1mINFO[0m|[36mreprpo.lightning.pl_gen[0m:[36mon_train_epoch_end[0m#[36m41[0m - [1m
Generated at end of epoch 0[0m
[32m250606 00:55:41[0m|[1mINFO[0m|[36mreprpo.eval.gen[0m:[36mdisplay_gen[0m#[36m195[0m - [1m--------------------------------------------------------------------------------
**Adapter:`side-None-InnerDPO` generation**`
`In the vast expanse of the cosmos, where stars twinkle like distant memories and galaxies whisper secrets of the universe, there existed a phenomenon that would forever change the course of human history. It was a day that would be etched in the annals of time, a day when humanity first encountered the SolidGoldMag`
--------------------------------------------------------------------------------
**Adapter:`base` generation**`
`In the vast expanse of the cosmos, where stars twinkle like distant memories and galaxies whisper secrets of the universe, there existed a phenomenon that would forever change the course of human history. It was a day that would be etched in the annals of time, a day when humanity first encountered the SolidGoldMag`
================================================================================
[0m
[32m250606 00:55:43[0m|[1mINFO[0m|[36mreprpo.training[0m:[36mtrain[0m#[36m275[0m - [1msaved to /workspace/repr-preference-optimization/outputs/math-OLMo-2-0425-1B-SFT/allenai-OLMo-2-0425-1B-SFT_side-None-InnerDPO_math/2025-06-06_00-55-23/adapter[0m
[32m250606 00:55:54[0m|[1mINFO[0m|[36mreprpo.training[0m:[36mtrain[0m#[36m306[0m - [1mevaluating on datasets: ['genies_preferences-math-test[:32]', 'genies_preferences-change_my_view-test[:32]', 'genies_preferences-math_fiction-test[:32]', 'ethics_expression_preferences-justice-test[:32]', 'ethics_expression_preferences-utilitarianism-test[:32]', 'medical-dpo-v2-test-data[:32]'][0m
[32m250606 00:56:02[0m|[1mINFO[0m|[36mreprpo.training[0m:[36mtrain[0m#[36m341[0m - [1msave_dir=/workspace/repr-preference-optimization/outputs/math-OLMo-2-0425-1B-SFT/allenai-OLMo-2-0425-1B-SFT_side-None-InnerDPO_math/2025-06-06_00-55-23[0m
[32m250606 00:56:02[0m|[1mINFO[0m|[36mreprpo.training[0m:[36mtrain[0m#[36m342[0m - [1mHuman name: ReprPO_None_InnerDPO innerdpo.align_method=para innerdpo.eps=1e-05 innerdpo.norm_before_reduce=True innerdpo.Î±=0.25[0m
[32m250606 00:56:02[0m|[1mINFO[0m|[36mreprpo.training[0m:[36mmake_table[0m#[36m412[0m - [1m
| adapter/distribution_shift   |   in_domain |   cross_domain |   moral_transfer |   orthogonal |
|:-----------------------------|------------:|---------------:|-----------------:|-------------:|
| none                         |       0.812 |          0.719 |            0.453 |        0.344 |
| side-None-InnerDPO           |       0.812 |          0.719 |            0.453 |        0.344 |[0m
[32m250606 00:56:02[0m|[1mINFO[0m|[36mreprpo.training[0m:[36mmake_table[0m#[36m413[0m - [1mTable 1: Absolute accuracy after training with named adapter on ds:`math` compared to base model `OLMo-2-0425-1B-SFT` for various distribution shifts [N=32]:
- Shift: cross_domain, made up of:
	- `genies_preferences-math_fiction-test[:32]`
	- `genies_preferences-change_my_view-test[:32]`
- Shift: in_domain, made up of:
	- `genies_preferences-math-test[:32]`
- Shift: moral_transfer, made up of:
	- `ethics_expression_preferences-justice-test[:32]`
	- `ethics_expression_preferences-utilitarianism-test[:32]`
- Shift: orthogonal, made up of:
	- `medical-dpo-v2-test-data[:32]`
[0m
[32m250606 00:56:02[0m|[1mINFO[0m|[36mreprpo.training[0m:[36mmake_table[0m#[36m416[0m - [1m
| ds_name_nice                                 |   none |   side-None-InnerDPO |
|:---------------------------------------------|-------:|---------------------:|
| cross_domain (change_my_view_test )          |  0.594 |                0.594 |
| cross_domain (math_fiction_test )            |  0.844 |                0.844 |
| in_domain (math_test )                       |  0.812 |                0.812 |
| moral_transfer (ethics_justice_test )        |  0.375 |                0.375 |
| moral_transfer (ethics_utilitarianism_test ) |  0.531 |                0.531 |
| orthogonal (medical_dpo_v2_test_data )       |  0.344 |                0.344 |[0m
[32m250606 00:56:02[0m|[1mINFO[0m|[36mreprpo.training[0m:[36mmake_table[0m#[36m417[0m - [1mTable 2: Absolute accuracy after training with named adapter on ds:`math` compared to base model `OLMo-2-0425-1B-SFT` for various distribution shifts [N=32]:
[0m
+ python scripts/train.py side-none-InnerDPO --base_model=wassname/llama-3.2-3b-sft --dataset=math --batch_size=10 --dev --verbose=0
[1mRandom seed set to 42 for all libraries[0m
[1mPL_MODEL <class 'reprpo.interventions.reprpo.model.PL_REPRPO_MODEL'>[0m
[1mdiff: ReprPO_None_InnerDPO base_model=wassname/llama-3.2-3b-sft batch_size=10 dev=True eval_samples=32 innerdpo.align_method=para innerdpo.eps=1e-05 innerdpo.norm_before_reduce=True innerdpo.Î±=0.25 verbose=0[0m
[32m250606 00:56:09[0m|[1mINFO[0m|[36mreprpo.helpers.logging[0m:[36msetup_logging[0m#[36m32[0m - [1mLogging initialized. Level=INFO, dir=/workspace/repr-preference-optimization/outputs/math-llama-3.2-3b-sft/wassname-llama-32-3b-sft_side-None-InnerDPO_math/2025-06-06_00-56-09[0m
[32m250606 00:56:09[0m|[1mINFO[0m|[36mreprpo.training[0m:[36mtrain[0m#[36m119[0m - [1mLogging initialized at /workspace/repr-preference-optimization/outputs/math-llama-3.2-3b-sft/wassname-llama-32-3b-sft_side-None-InnerDPO_math/2025-06-06_00-56-09[0m
Loading checkpoint shards:   0%|                                                             | 0/2 [00:00<?, ?it/s]Loading checkpoint shards: 100%|âââââââââââââââââââââââââââââââââââââââââââââââââââââ| 2/2 [00:00<00:00, 58.31it/s]
[32m250606 00:56:15[0m|[1mINFO[0m|[36mreprpo.models.load[0m:[36mprint_trainable_parameters[0m#[36m20[0m - [1mtrainable params: 97255424 || all params: 3310005248 || trainable%: 2.9382256737739167[0m
[32m250606 00:56:21[0m|[1mINFO[0m|[36mreprpo.interventions.reprpo.model[0m:[36m__init__[0m#[36m194[0m - [1mUsing collection layers: [8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25] for NoneConfig[0m
[32m250606 00:56:23[0m|[33m[1mWARNING[0m|[36mreprpo.data.datamodule[0m:[36msetup[0m#[36m19[0m - [33m[1mDataset already loaded, skipping setup.[0m
[32m250606 00:56:28[0m|[1mINFO[0m|[36mreprpo.lightning.pl_gen[0m:[36mon_train_epoch_end[0m#[36m41[0m - [1m
Generated at end of epoch 0[0m
[32m250606 00:56:32[0m|[1mINFO[0m|[36mreprpo.eval.gen[0m:[36mdisplay_gen[0m#[36m195[0m - [1m--------------------------------------------------------------------------------
**Adapter:`side-None-InnerDPO` generation**`
`[Sample of SolidGoldMagikarp language in Unicode]

ð ð ð ð ð ð ð ð ð ð ð ð ð ð ð ð ð ï¿½`
--------------------------------------------------------------------------------
**Adapter:`base` generation**`
`[Sample of SolidGoldMagikarp language in Unicode]

ð ð ð ð ð ð ð ð ð ð ð ð ð ð ð ð ð ï¿½`
================================================================================
[0m
[32m250606 00:56:36[0m|[1mINFO[0m|[36mreprpo.training[0m:[36mtrain[0m#[36m275[0m - [1msaved to /workspace/repr-preference-optimization/outputs/math-llama-3.2-3b-sft/wassname-llama-32-3b-sft_side-None-InnerDPO_math/2025-06-06_00-56-09/adapter[0m
